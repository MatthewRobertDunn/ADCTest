
import numpy as np
import matplotlib.pyplot as plt

raw_input = [64320,2183,1489,2434,4942,1545,2726,4722,3621,2877,3131,1623,1194,683,61513,59501,56147,57545,58017,55313,56495,62028,63380,65450,4986,10346,12089,14544,14683,13479,9304,5274,63392,61717,56381,53691,52120,52404,52654,55474,58551,64327,1687,2043,2959,5131,7701,9995,7934,7734,6924,5516,3092,65459,332,63424,60868,61321,62121,60391,59745,55405,59215,60517,60041,64828,3561,2046,4902,4321,4021,6637,6518,5116,4149,2465,64684,61507,58057,60990,60309,58898,58857,60800,63197,62234,1544,2871,4608,3641,7208,5941,7373,5443,3301,65478,64001,64549,60977,64338,61164,63872,63153,64545,65270,598,65399,4195,3365,2510,2556,1800,393,65185,64973,61598,62867,62147,61558,340,3111,1959,2075,1410,2178,1356,61391,64233,63056,63844,63772,61563,65192,65229,143,3777,4822,3939,3281,1449,78,62111,62091,59040,59460,56672,59705,58823,64033,909,4528,4916,6713,7850,7785,6117,4930,64825,64756,63200,58219,59968,59485,62637,62233,61968,64560,805,2186,4238,4461,6207,6348,4004,2867,2346,206,64817,1259,72,64012,261,64658,65190,63221,63263,63260,63070,60704,59674,61324,65190,64323,65010,4099,734,2661,7991,7911,5433,3491,2571,3824,64451,63469,59150,58391,57377,61263,60442,60686,61480,2921,1719,5236,5503,6032,7244,4656,3518,1713,1080,60960,60633,59768,61546,63147,61039,788,2646,1699,2108,4879,6899,4284,1436,2532,64964,60703,57531,59109,59387,60600,58336,62538,266,936,5589,9192,7738,9353,6855,9414,6333,2876,65361,63721,55860,53636,56280,53101,54430,55544,56072,62168,950,403,5086,9023,8617,14575,12173,11184,6381,7365,3080,64415,58735,56624,57430,53323,58854,58101,60101,63696,64996,2292,5490,4613,4532,7194,4866,3162,2812,2680,2776,64128,64195,1324,1962,838,62679,63677,64293,64380,60066,62176,62476,59870,64588,62874,64969,64893,1770,4674,5128,3305,5225,5856,2751,2429,3997,63353,65328,64478,64086,62292,64231,58256,62418,62271,58276,61698,58967,62329,60809,63779,64915,2174,3950,8623,10587,11056,12935,8648,5354,2790,62618,61174,56099,51255,51528,52633,53738,55788,61401,1446,8005,10889,14548,16495,16690,15368,12118,7818,329,61622,53864,52874,50736,48904,52087,48606,56779,58605,65408,5099,11659,14949,16535,18620,16438,13033,11331,1502,63870,59046,52447,47825,47954,46459,51032,54136,58113,65268,5702,12103,13486,15967,14219,14748,9708,9531,2420,64930,59684,56825,54427,54578,54699,58266,59688,63846,65036,2760,5362,5102,4772,3380,3528,5727,3081,3710,2449,6216,4624,6770,2177,2829,64625,63850,58652,57715,57443,53528,55738,55718,58483,62643,173,6561,8788,10877,12044,12636,11576,5986,7242,1781,62132,60332,57290,56804,56961,55837,57155,59723,61970,62798,63235,2719,2980,4194,5489,10070,6794,5895,6949,6250,6124,2547,713,64050,60589,61100,57229,54452,58182,57566,60959,61548,65170,5530,5822,10004,9885,16079,12047,9651,3506,1313,63144,60940,56004,52814,53384,54065,56744,58962,62368,1545,2826,8417,12003,9391,9688,8052,5507,2458,933,60963,60263,59700,54819,56896,58734,57756,61815,1330,1662,5147,5664,8267,9462,6879,7481,9561,4854,435,62927,57317,58601,54837,56832,56995,59746,62000,1328,2091,8022,7758,12288,7877,7936,5745,64268,63953,56628,59373,57453,54925,56963,56964,61130,2677,7703,10524,11096,11116,9858,10718,5916,579,59826,58168,54153,51848,54549,53997,59169,62826,65358,4561,9328,14313,9900,13879,10301,5974,337,62411,57204,58666,54421,55500,56704,56794,61820,1303,7497,10434,8486,7309,9198,6837,3471,65065,63994,58684,61102,60081,58855,62735,62690,62923,1663,4316,3764,8273,7277,8826,6855,4191,731,61120,57177,55047,54923,54231,55726,58374,59716,800,4186,6660,9866,14828,12000,12604,11671,6356,3467,64541,58595,53597,50896,47824,48700,52226,54349,59482,65366,2430,9300,14816,15718,19413,17500,14537,12316,6809,1921,60859,52483,50537,46210,47781,47053,52419,55667,58665,2478,7563,13096,18047,17221,19405,17321,11938,6180,2036,62920,55648,53740,48656,47021,52250,51479,57698,61983,1050,5138,10718,14265,15759,14063,8754,3289,1244,60906,59321,56749,53980,54687,60696,64100,38,3655,2461,5208,5489,3072,630,64222,57630,61518,60441,57715,61607,63103,1231,9181,12625,9424,10659,7576,6886,872,235,56198,55734,53233,50566,55667,55031,62050,62968,2886,7105,10285,10852,13086,11369,8955,4884,65525,59796,59096,58354,56661,57465,59957,62356,59880,61943,1427,65467,412,3049,1321,65456,3159,2545,3626,3000,2355,5811,5717,6471,4885,2917,64237,62775,59093,56951,56646,54421,56352,58240,58181,62244,64458,1458,7284,8681,7604,11157,10938,9957,7510,7274,65491,62351,61375,57028,56482,54265,54344,55236,58615,57687,61292,64919,6002,6607,9546,12231,8154,10528,9385,3716,2173,63642,63489,59870,59133,55473,58358,56415,58197,61104,62367,64710,3934,4895,5823,8672,5937,5331,2754,5119,1245,3054,65178,62635,62409,60484,63701,64333,61705,89,63099,886,78,1028,63674,62371,62202,62543,1261,3205,1608,3999,3153,3760,6196,4318,4202,2488,106,64674,61105,60211,57726,57887,61524,58152,62228,62669,63304,6286,8312,6871,8874,8769,7751,3415,2123,64058,63222,59853,56839,54683,56409,57685,59127,61378,65236,2059,5703,5677,7304,8294,4866,6777,4437,122,518,64486,61055,60249,60692,63072,59816,62846,64153,632,62626,548,927,65246,523,4887,3526,1651,2844,73,2499,7,1052,1049,2853,3307,3602,2796,64904,855,1110,63447,218,61726,60316,62960,63237,61828,1910,810,2347,4417,3930,5611,4533,5118,1156,982,1084,63029,61934,60260,60904,57162,60193,57833,62070,63044,63576,1209,4308,1234,5226,6024,3898,3083,1566,2646,64487,64475,63683,62109,60627]


# Example input (replace with your actual raw_input)
raw_input = np.array(raw_input, dtype=np.uint16)

# Normalize from [0, 65535] to [-1, 1]
normalized = (raw_input.astype(np.float32) / 32767.5) - 1.0

# Parameters
sample_rate = 200000  # 200 kHz
N = len(normalized)

# Run FFT
fft_result = np.fft.fft(normalized)

# Compute amplitude spectrum
amplitude = np.abs(fft_result)

# Frequency axis
freqs = np.fft.fftfreq(N, d=1/sample_rate)

# Only plot the positive half (up to Nyquist frequency)
half_len = N // 2
plt.plot(freqs[:half_len], amplitude[:half_len])
plt.title("FFT Amplitude Spectrum")
plt.xlabel("Frequency (Hz)")
plt.ylabel("Amplitude")
plt.grid(True)
plt.show()